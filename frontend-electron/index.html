<!DOCTYPE html>
    <html lang="en">
    <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Focal</title>
      <link rel="stylesheet" href="styles.css">
    </head>
    <body>
      <div class="sidebar">
        <div class="profile">
          <img src="profile-bw.jpg" alt="Profile Picture">
          <h2>Daniel</h2>
        </div>
        <nav>
          <ul>
            <li><span class="icon">🏠</span> Home</li>
            <li><span class="icon">📅</span> Calendar</li>
            <li><span class="icon">📓</span> Journal</li>
            <li><span class="icon">📊</span> Statistics</li>
          </ul>
        </nav>
        <div class="settings">
          <ul>
            <li><span class="icon">⚙️</span> Settings</li>
            <li><span class="icon">🔓</span> Log Out</li>
          </ul>
        </div>
      </div>
      <div class="main-content">
        <header>
          <h1>General Information</h1>
          <button>Upgrade</button>
        </header>
        <div class="dashboard" id="dashboard">
          <div class="card gradient-bg settings">
            <canvas id="gaugeChart"></canvas>
            <script src="renderer.js"></script> </div>
          <div class="card gradient-bg">
            
            <div class = "chartCard">
              <div class="chartCard-content">
                <div id="line-chart"></div>
              </div>
            </div>

            <button id="viewAll" onclick="toggleCarousel()">
                View All
            </button>


          </div>
          <div class="card gradient-bg large-card">
          

            <div class="input-container">
              <button id="cameraBtn" class="camera-btn">
                  <span class="camera-icon">📷</span>
              </button>
              <button id="screenBtn" class="screen-btn">
                  <span class="screen-icon">🖥️</span>
              </button>

              <button id="micBtn" class="mic-btn">
                  <span class="mic-icon">🎤</span>
              </button>

              <input type="text" id="messageInput" placeholder="Enter the task you want to focus on">
            </div>
          </div>
        </div>
       <div class="carousel" id="carousel">
            <button onclick="toggleCarousel()">Back</button>
            <div class="carousel-container">
              <div class="carousel-slide" id="carousel-slide">
                <div class="image-placeholder" style="background-color: #000000; background-image: url(./assets/gaze_heatmap_overlay.png);" ></div>
              </div>
            </div>
        </div>
        <!-- TODO: This is here to make the integration works for now. -->
        <div style="display:none;">
          <div id="chatHistory" class="chat-history"></div>

          <button id="disconnectBtn" class="disconnect-btn">Disconnect</button>
          <button id="connectBtn" class="connect-btn" style="display: none;">Connect</button>
          <button id="settingsBtn" class="settings-btn">⚙️</button>
          <button id="cameraBtn" class="camera-btn">
              <span class="camera-icon">📷</span>
          </button>
          <button id="screenBtn" class="screen-btn">
              <span class="screen-icon">🖥️</span>
          </button>
          <button id="micBtn" class="mic-btn">
              <span class="mic-icon">🎤</span>
          </button>
          <div id="chatHistory" class="chat-history"></div>
          <canvas id="visualizer" class="visualizer"></canvas>
          <div id="cameraPreview" class="camera-preview"></div>
          <div id="screenPreview" class="screen-preview"></div>
          <div class="text-input-container">
              <input type="text" id="messageInputOriginal" placeholder="Type your message..." class="text-input">
              <button id="sendBtn" class="send-btn">➤</button>
          </div>
        </div>

      <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
      <script src="./script.js"></script>
      <script type="module" src="./js/script.js"></script>
      <script>
          // Require Node.js modules (works if nodeIntegration is enabled)
          const path = require('path');

          // Define the path to your screenshots directory (adjust if necessary)
          const screenshotsDir = path.join(__dirname, 'screenshots');

          // Read the directory
          fs.readdir(screenshotsDir, (err, files) => {
            if (err) {
              console.error("Error reading the screenshots directory:", err);
              return;
            }

            // Filter files to include only common image extensions
            const imageFiles = files.filter(file => /\.(jpg|jpeg|png|gif)$/i.test(file));

            // Get the container where image elements will be inserted
            const carouselSlide = document.getElementById('carousel-slide');

            // Loop through each image file and create a new div for it
            imageFiles.forEach(file => {
              const fullPath = path.join(screenshotsDir, file);
              
              // Create the image placeholder div
              const imageDiv = document.createElement('div');
              imageDiv.classList.add('image-placeholder');

              // Set the background image.
              // Use the file:// protocol to reference local files.
              imageDiv.style.backgroundImage = `url("file://${fullPath}")`;

              // Append the new div to the carousel slide container
              carouselSlide.appendChild(imageDiv);
            });
          });




          let dashboard = document.getElementById("dashboard");
          let carousel = document.getElementById("carousel");
          function toggleCarousel(){
            console.log("toggled")
            console.log(dashboard.style.display.toString());
            if(dashboard.style.display == "grid"){
              carousel.style.display = "block";
              dashboard.style.display = "none";
            } else{
              carousel.style.display = "none";
              dashboard.style.display = "grid";
            }
          }

          
                    
          const carouselSlide = document.querySelector('.carousel-slide');
          let images = document.querySelectorAll('.image-placeholder');
          console.log("images length: "+ images.length );
          let counter = 0;


          let size = images[0].clientWidth;
          carousel.style.display="none";

          carouselSlide.style.transform = 'translateX(' + (-size * counter) + 'px)';
          console.log("here1")
          document.addEventListener('keydown', (event) => {
            images = document.querySelectorAll('.image-placeholder');
            size = images[0].clientWidth;
            if (event.key === 'ArrowLeft') {
              console.log("LEFT: " + counter);
              counter--;
              if (counter < 0) {
                counter = images.length - 1;
              }
              carouselSlide.style.transform = 'translateX(' + (-size * counter) + 'px)';
            } else if (event.key === 'ArrowRight') {
              console.log("RIGHT: " + counter);
              counter++;
              if (counter >= images.length) {
                counter = 0;
              }
              carouselSlide.style.transform = 'translateX(' + (-size * counter) + 'px)';
            }
          });
          
        </script>

    </body>
    </html>
